"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[843],{9843:(L,u,r)=>{r.r(u),r.d(u,{default:()=>M});var g=r(9569),_=r(6895),h=r(2876),s=r(433),d=r(9061),m=r(5609),p=r(3189),t=r(1571),C=r(7556),f=r(4295),Z=r(4631);function T(n,l){if(1&n&&(t.TgZ(0,"option",37),t._uU(1),t.qZA()),2&n){const e=l.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.piece_name)}}function A(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"tr",27)(1,"td")(2,"div",28),t._UZ(3,"input",29),t.TgZ(4,"select",30),t.YNc(5,T,2,2,"option",31),t.qZA()()(),t.TgZ(6,"td")(7,"div",32),t._UZ(8,"textarea",33),t.qZA()(),t.TgZ(9,"td")(10,"div",28),t._UZ(11,"input",34),t.qZA()(),t.TgZ(12,"td")(13,"button",35),t.NdJ("click",function(){const a=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.onRemoveRow(a))}),t._UZ(14,"i",36),t._uU(15,"Remove"),t.qZA()()()}if(2&n){const e=l.$implicit,i=t.oxw(2);t.xp6(4),t.Q6J("formControl",e.get("piece")),t.xp6(1),t.Q6J("ngForOf",i.piece),t.xp6(3),t.Q6J("formControl",e.get("description")),t.xp6(3),t.Q6J("formControl",e.get("quantite"))}}function v(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",11)(1,"h4",12),t._uU(2,"Listez les r\xe9paration pour cette voiture"),t.qZA(),t.TgZ(3,"button",13),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.KtG(a.dismiss("Cross click"))}),t.TgZ(4,"span",14),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",15)(7,"div",16)(8,"table",6)(9,"thead",17)(10,"tr")(11,"th"),t._uU(12," Pi\xe8ces "),t.qZA(),t.TgZ(13,"th"),t._uU(14," Descriptions "),t.qZA(),t.TgZ(15,"th"),t._uU(16," Quantit\xe9s "),t.qZA()()(),t.TgZ(17,"tbody",18),t.YNc(18,A,16,4,"tr",19),t.qZA()()(),t.TgZ(19,"div",1)(20,"div",20)(21,"h4",21),t._uU(22,"Ajouter un \xe9lement \xe0 r\xe9parer"),t.qZA()(),t.TgZ(23,"div",22)(24,"button",23),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onAddRow())}),t._UZ(25,"i",24),t._uU(26,"Add"),t.qZA()()()(),t.TgZ(27,"div",25)(28,"button",26),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.close())}),t._uU(29,"Ok"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("formGroup",e.addForm),t.xp6(11),t.Q6J("ngForOf",e.addForm.get("rows").controls)}}function E(n,l){1&n&&(t.TgZ(0,"td")(1,"span",40),t._uU(2,"En r\xe9paration"),t.qZA()())}function x(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"td")(1,"button",41),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw(),c=t.MAs(1);return t.KtG(a.open(c,o._id))}),t._uU(2,"Lister les r\xe9parations"),t.qZA()()}}function b(n,l){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"img",38),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.YNc(11,E,3,0,"td",39),t.YNc(12,x,3,0,"td",39),t.qZA()),2&n){const e=l.$implicit;t.xp6(2),t.s9C("src",e.image,t.LSH),t.xp6(2),t.Oqu(e.marque),t.xp6(2),t.Oqu(e.type),t.xp6(2),t.Oqu(e.moteur),t.xp6(2),t.Oqu(e.immatriculation),t.xp6(1),t.Q6J("ngIf","1"==e.status),t.xp6(1),t.Q6J("ngIf","0"==e.status)}}function O(n,l){1&n&&(t.TgZ(0,"div",42)(1,"h3"),t._uU(2," Loading... "),t.qZA()())}const U=function(){return{backdropBorderRadius:"3px"}};let M=(()=>{class n{constructor(e,i,o,a,c){this.authService=e,this.receptionService=i,this.datePipe=o,this.modalService=a,this.fb=c,this.loading=!1,this.authService.isAtelier(),this.datePipe=o,this.modalOptions={backdrop:"static",backdropClass:"customBackdrop",size:"lg",windowClass:"modal-xl"},this.addForm=this.fb.group({items:[null,s.kI.required],items_value:["no",s.kI.required]}),this.rows=this.fb.array([])}ngOnInit(){this.getPieces(),this.getCar()}open(e,i){this.idcar=i,console.log(i),this.modalService.open(e,this.modalOptions).result.then(o=>{this.closeResult=`Closed with: ${o}`},o=>{this.closeResult=`Dismissed ${this.getDismissReason(o)}`})}close(){this.loading=!0;const e={Car:this.idcar,reparation:this.rows.getRawValue()};console.log(e),this.modalService.dismissAll(),this.receptionService.reparation(e).subscribe(a=>{200==a.status&&(this.loading=!1,window.location.reload())},a=>{this.loading=!1,this.message=a.message})}getDismissReason(e){return e===d.If.ESC?"by pressing ESC":e===d.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${e}`}getPieces(){this.loading=!0,this.receptionService.getAllpiece().subscribe(o=>{this.loading=!1,this.piece=o.piece,console.log("All piece",this.piece)},o=>{this.loading=!1,this.message=o.message})}getCar(){this.loading=!0,this.receptionService.getCar().subscribe(o=>{this.loading=!1,this.list=o.car},o=>{this.loading=!1,this.message=o.message})}onAddRow(){this.rows.push(this.createItemFormGroup()),this.addForm.get("items_value").setValue("yes"),this.addForm.addControl("rows",this.rows)}onRemoveRow(e){this.rows.removeAt(e)}createItemFormGroup(){return this.fb.group({piece:null,description:null,quantite:null,statut:"En cours"})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C.e),t.Y36(f.G),t.Y36(_.uU),t.Y36(d.FF),t.Y36(s.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-list-car"]],standalone:!0,features:[t.jDz],decls:29,vars:9,consts:[["mymodal",""],[1,"row"],["cardTitle","R\xe9ception des voitures"],[1,"form-group"],[1,"col-md-5"],["type","text","placeholder","rechercher",1,"form-control",3,"ngModel","ngModelChange"],[1,"table"],[4,"ngFor","ngForOf"],[1,"my-container"],["customLoadingTemplate",""],[3,"show","config","template"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"table-responsive","pt-3",3,"formGroup"],[1,"table-dark"],["id","tbcontenu"],["id","ligne",4,"ngFor","ngForOf"],[1,"col-8"],[2,"margin-left","130px"],[1,"col-4"],[1,"btn","btn-success",3,"click"],[1,"mdi","mdi-plus"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],["id","ligne"],[1,"col-sm-8"],["type","text","rows","3","min","0","max","50",1,"form-control",2,"display","none"],["aria-label","Default select example","rows","3",1,"form-select",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-10"],["rows","3",1,"form-control",2,"overflow-y","scroll",3,"formControl"],["type","number","rows","3","min","0","max","50",1,"form-control",3,"formControl"],[1,"btn","btn-danger",3,"click"],[1,"mdi","mdi-delete"],[3,"value"],["alt","",2,"width","100px","border-radius","5px",3,"src"],[4,"ngIf"],[1,"badge","text-bg-success"],[1,"btn","btn-secondary",3,"click"],[1,"custom-class"]],template:function(e,i){if(1&e&&(t.YNc(0,v,30,2,"ng-template",null,0,t.W1O),t.TgZ(2,"div",1)(3,"app-card",2)(4,"div",3)(5,"div",4)(6,"input",5),t.NdJ("ngModelChange",function(a){return i.filterTerm=a}),t.qZA()()(),t.TgZ(7,"table",6)(8,"thead")(9,"tr")(10,"th"),t._uU(11,"Images"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Marques"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Types"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Moteurs"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Immatricules"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Actions"),t.qZA()()(),t.TgZ(22,"tbody"),t.YNc(23,b,13,7,"tr",7),t.ALo(24,"filter"),t.qZA()()()(),t.TgZ(25,"div",8),t.YNc(26,O,3,0,"ng-template",null,9,t.W1O),t._UZ(28,"ngx-loading",10),t.qZA()),2&e){const o=t.MAs(27);t.xp6(6),t.Q6J("ngModel",i.filterTerm),t.xp6(17),t.Q6J("ngForOf",t.xi3(24,5,i.list,i.filterTerm)),t.xp6(5),t.Q6J("show",i.loading)("config",t.DdM(8,U))("template",o)}},dependencies:[_.ez,_.sg,_.O5,h.m,s.YN,s.Kr,s.Fj,s.wV,s.EJ,s.JJ,s.JL,s.qQ,s.Fd,s.On,s.oH,s.sg,Z.A,g.Bz,s.UX,m.q,m.RJ,p.h,p.Z],styles:[".modal-xl[_ngcontent-%COMP%]   .modal-lg[_ngcontent-%COMP%]{max-width:95%}"]}),n})()}}]);